# DOM API

> Осторожно, тут про JavaScript

**DOM API** - есть ни что иное, как определенные в глобальной области видимости методы, по которым **JavaScript** код может взаимодействовать с [**DOM**](./dom.md).

## document и window

**document** - объект в глобальной области видимости, через который **JS**-код может взаимодействовать с **HTML** документом.  

**window** - объект в глобальной области видимости, через который **JS**-код может взаимодействовать с текущим окном браузера. Помимо этого объект **window** сам по себе "и есть глобальная область видимости".

> Дальнейшее описание может быть отчасти неприменимо к работе в некоторых браузерах. Это происходит потому, что почти у каждого браузера своя реализация и DOM, и движка JS.

## Селекторы

**Селектор** - это идентификатор узла/узлов в **DOM**.  
Селекторы бывают простыми и составными.  

Простой селектор - это селектор:  
*тега*  
`<div><p>Hello</p></div>`, селектор абзатца просто имя тега `p`

*класса*  
`<div><p class="target">Hello</p></div>`, селектор абзатца имя класса после точки `.target`

*id*  
`<div><p id="target">Hello</p></div>`, селектор абзатца имя id после решетки `#target`

*псевдокласса*  
`<div><input name="test" type="text"/></div>`, селектор активного поля ввода имя псевдокласса `input:focus`  

или *атрибута*.  
`<div><input name="test" type="text"/></div>`, селектор текстового поля ввода `input[type=text]`

также может быть селектор **\*** - захватывающий все элементы.  

Составной селектор - это селектор, состоящий из нескольких простых по следующим правилам:  
простые селекторы идущие подряд без пробелов, описывают один и тот же элемент,  
`.node.andthis` - два класса одного элемента  

идущие подряд через пробел, описывают элемент, находящийся внутри другого элемента,  
`.parent .child`  

помимо этого есть управляющие символы **>**, **+** и другие.  
\> - строгое наследование, то есть один элемент является потомком другого "в первом поколении",
\+ - соседний элемент  
`.div-1 + .div-2` - выбирается элемент с классом div-2, идущий сразу за элементом с классом div-1.

## События

**События** - это механизм сигнализирования браузера о том, что что-то произошло. События могут быть глобальными для документа или же относиться к отдельному элементу.  

### Часто используемые события

* `click` - событие элемента, при клике по нему,  
* `submit` - отправка формы,  
* `focus` - установка фокуса в элементе формы,  
* `keydown`/`keyup` - нажатие и отпускание клавиши,  
* `DOMContentLoaded` - весь контент страницы загружен,
* `onload` - элемент загружен,
* `onerror` - произошла ошибка при загрузке элемента.

### Применение

Каждому событию может быть назначен обработчик в виде функции **JS**.  
каждому элементу **DOM** можно задать обработчик через свойство элемента `onИмяСобытия`, например для картинки:  
`<img src="somepic.jpg" onload="alert('Успех!');" onerror="alert('не успех');"/>`,  
либо `document.querySelector("img").onload = function(){alert("Успех!");};`.

В метод(функцию) обработчик в качестве аргумента попадет объект **event**, описывающий событие, плюс внутри метода будет доступен объект **this**, указывающий на элемент, породивший событие.

## Методы DOM API

> Наиболее популярные

* `document.getElementById(id)` - возвращает элемент по id,
* `document.getElementsByTagName(name)` - возвращает элементы указанного типа(тега),
* `document.getElementsByClassName(name)` - возвращает элементы с указанным именем класса,
* `document.querySelector(selector)` - возвращает первый элемент, соответствующий селектору,
* `document.querySelectorAll()` - возвращает все элементы, соответствующие селектору,
* `window.alert(message)` - выводит предупреждение пользователю, удобно использовать для проверок, отладок итд,
* `element.innerHTML` - выводит внутреннее содержимое элемента,
* `element.setAttribute(name, val)` - устанавливает аттрибут элементу с именем name и значением val,
* `element.getAttribute(name)` - возвращает значение аттрибута name,
* `element.addEventListener(eventName, handler)` - добавляет обработчик handler для события с именем eventName,
* `element.onload` - свойство, вызываемое при загрузке содержимого элемента,
* `element.onerror` - свойство, вызываемое при ошибке загрузки содержимого элемента,
* `console.log(data)` - выводит в консоль браузера переданные данные.

## Итого

Важно запомнить, что **JS** может взаимодействовать в любой момент с содержимым документа, менять его, подписываться на события и вообще имеет всю полноту власти на данными в документе.

[← Назад](../README.md)