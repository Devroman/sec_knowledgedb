# Template Injection

Эксплуатация уязвимостей средств шаблонизации.  

> Чаще всего Template Injection - прямой путь к XSS

Делят на:

* **Server Side Template Injection (SSTI)** - атака на серверные шаблонизаторы
* **Client Side Template Injection (CSTI)** - атака на клиентские шаблонизаторы

Возникает опять же при логических ошибках на этапе разработки, пренебрежения рекомендациями разработчиков шаблонизаторов, багов шаблонизаторов и при недостаточном экранировании или его отсутствии.  

Пример: 

1. Есть страница, куда через шаблонизатор подставляется пользовательский ввод  
`<h1>Hello, {{ username }}</h1>`
2. Атакующий вводит в `username` поле `5*5`
3. В шаблонизаторе получается `{{ 5*5 }}`
4. На странице  
`<h1>Hello, 25</h1>`

Соответственно вместо `5*5` может быть вызов серверных переменных, обфусцированный **JS** для обхода фильтрации, **HTML** разметка итд.

Разница между **SSTI** и **CSTI** в том, что на сервере доступна работа с серверным окружением, а на клиенте только манипуляция с **JS**.  

## Эксплуатация

1. Используя плагины браузера, сканеры, самостоятельное наблюдение определяем в лучшем случае сам шаблонизатор, в худшем язык разработки.  
2. Находим соответствующую документацию.
3. Изучаем синтаксис, рекомендации по безопасности, список встроенных методов
4. Пробуем обойти фильтрацию
5. В случае успеха раскручиваем через другие атаки, например **XSS**

## Защита

* Фильтруем пользовательский ввод
* Учитываем рекомендации разработчиков шаблонизатора
* Делаем шаблоны максимально тупыми

[← Назад](../README.md)