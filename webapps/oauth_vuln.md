# OAuth vulnerability

Уязвимости и атаки на некоторые реализации **OAuth**.

## Эксплуатация

### Отсутствие проверки редиректа

При вызове **OAuth** авторизации подставляем в **redirect_uri** адрес подконтрольного ресурса => получаем токен.  
`https://auth.example.com/token?client_id=CLIENT_ID&client_secret=CLIENT_SECRET&grant_type=authorization_code&code=AUTHORIZATION_CODE&redirect_uri=http://evil.com`

### Referer leak

Если на странице на которую возвращается редирект есть подключаемые ресурсы со стороннего домена, то к нему может утечь токен приложения.  

### XSS

Проведя на атакуемом ресурсе **XSS** атаку можно получить **token** и в последствии воспользоваться им. Правильная реализация **OAuth 2.0** подразумевает, что токен нужен только для того, чтобы разово запросить авторизационный секрет, после чего токен должен быть удален, забыт, выброшен.  

## Защита

1. Придерживаться рекомендаций спецификации
2. Строго привязывать **redirect_uri** к токену доступа приложения
3. Не держать внешних ресурсов на странице для редиректа
4. Использовать токен доступа клиента однократно (см.п. 1)

[← Назад](../README.md)
